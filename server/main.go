package main

import (
	"log"

	"github.com/javierpoduje/2c1s/server/sender"
	"github.com/joho/godotenv"
	"math/rand"
)

const (
	BoardWidth  = 13
	BoardHeight = 13
)

func diamondRing() [][]int {
	return [][]int{
		{0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0},
		{0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0},
		{0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0},
		{0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
		{1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1},
		{0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0},
		{0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0},
		{0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0},
		{0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
	}
}

func achimsP4() [][]int {
	return [][]int{
		{0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0},
		{0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0},
		{1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0},
		{1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0},
		{0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	}
}

func fourEightTwelveDiamond() [][]int {
	return [][]int{
		{0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	}
}

func main() {
	err := godotenv.Load("../.env")
	if err != nil {
		log.Fatal("Error loading .env file")
	}

	seeds := []func() [][]int{
		diamondRing,
		achimsP4,
		fourEightTwelveDiamons,
	}

	// make a random choose between the seeds, copilot
	seed := seeds[randomIdx(seeds)]

	s := sender.NewServer(BoardWidth, BoardHeight, seed())
	s.Start(BoardWidth, BoardHeight, seed())
}

func randomIdx(seeds []func() [][]int) int {
	return rand.Int() % len(seeds)
}
